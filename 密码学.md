# 对称加密

**定义**：使用**同一个密钥**进行加密和解密的技术。

**典型算法**：

- AES（高级加密标准）
- DES/3DES

**优点**：

1. **速度快**：适合加密大量数据（如文件、网络传输）。
2. **资源消耗低**：对计算性能要求较低。

**缺点**：

1. **密钥管理复杂**：通信双方需安全共享密钥，易被中间人窃取。
2. **无法验证身份**：无法确认发送方或接收方的身份真实性。

**应用场景**：

- 数据存储加密（如硬盘加密）。
- 网络通信加密（如 VPN、HTTPS 中的数据传输阶段）。
- 加密文件传输（如加密压缩包）。

# **非对称加密**

**定义**：使用**一对密钥**（公钥和私钥），公钥公开，私钥保密。

**原理**：

1. **加密**：发送方用接收方的公钥加密数据。
2. **解密**：接收方用自己的私钥解密数据。
3. **签名验证**：发送方用私钥签名，接收方用公钥验证签名真实性。

**典型算法**：

- RSA
- ECC（椭圆曲线加密）
- Diffie-Hellman

**优点**：

1. **密钥交换安全**：无需传输私钥，解决对称加密的密钥分发问题。
2. **身份验证**：可通过数字签名确认发送方身份。

**缺点**：

1. **速度慢**：加密和解密计算量较大，不适合加密大量数据。
2. **密钥长度要求高**：需足够长度保证安全性（如 RSA 通常需 2048 位以上）。

**应用场景**：

- 密钥交换（如 HTTPS 握手阶段协商对称密钥）。
- 数字签名（如软件代码签名、电子文档认证）。
- 身份验证（如 SSH 远程登录）。

# HMAC（基于哈希的消息认证码）

#### **一、定义与核心目标**

**HMAC**（Hash-based Message Authentication Code）是一种通过**密钥与哈希函数结合**生成消息认证码的技术，用于验证数据的**完整性**和**真实性**。其核心目标是确保消息在传输过程中未被篡改，且来源可靠。

#### **二、核心组件**

1. **密钥（Key）**
   - 对称密钥，长度通常与哈希函数输出长度一致（如 SHA-256 使用 256 位密钥）。
   - 密钥必须保密，且每次使用需独立生成（避免重复使用）。
2. **哈希函数（Hash Function）**
   - 常用算法：SHA-1、SHA-256、SHA-512、MD5（不推荐，因存在安全漏洞）。
   - 要求：抗碰撞性、雪崩效应、不可逆性。
3. **填充（Padding）**
   - 当密钥长度小于哈希函数块大小时（如 SHA-256 块大小为 512 位），通过填充（如 PKCS#7）扩展密钥长度。

#### **三、工作原理**

HMAC 的计算分为以下步骤：

1. **密钥处理**
   - 若密钥长度超过哈希函数块大小，先对密钥进行哈希压缩。
   - 若密钥过短，填充至块大小。
2. **生成两个临时密钥**
   - **Inner Key**：密钥与固定值（`0x36`重复填充）异或。
   - **Outer Key**：密钥与固定值（`0x5C`重复填充）异或。
3. **组合消息与密钥**
   - 将 Inner Key 与消息拼接，计算哈希值（H1）。
   - 将 Outer Key 与 H1 拼接，再次计算哈希值（H2），即最终 HMAC 值。

**数学表达式**：$ \text{HMAC}(K, M) = H[(K \oplus \text{outer\_pad}) \mathbin\| H[(K \oplus \text{inner\_pad}) \mathbin\| M]] $其中：

- K 为密钥，M 为消息；
- $\oplus $为异或操作，$\mathbin\|$为拼接操作。

#### **四、安全性分析**

1. **抗篡改能力**
   - 任何对消息的修改会导致 HMAC 值变化，接收方验证失败。
2. **抗伪造性**
   - 攻击者若无密钥，无法生成有效的 HMAC。
3. **抗长度扩展攻击**
   - 传统哈希函数（如 SHA-1）易受长度扩展攻击，但 HMAC 通过密钥约束避免此问题。
4. **密钥管理**
   - 密钥需安全存储，避免泄露。建议使用随机生成的高强度密钥（如 256 位）。

#### **五、典型应用场景**

1. **数据完整性验证**
   - 网络传输中附加 HMAC 值，接收方重新计算并比对。
2. **API 签名**
   - 客户端与服务器通过 HMAC 验证请求合法性（如 AWS API 签名 v4）。
3. **安全协议中的认证**
   - **IPsec**：在 ESP 协议中使用 HMAC 验证数据包完整性。
   - **TLS**：通过 HMAC 计算记录层的 MAC 值。
4. **密钥交换**
   - 在 IKEv2 协议中，HMAC 用于验证身份和协商参数。
5. **密码存储**
   - 结合盐值（Salt）存储 HMAC 后的密码哈希（如 PBKDF2 算法）。

# 加盐哈希

#### **一、定义与核心目标**

**加盐（Salt）** 是密码学中用于增强哈希函数安全性的随机数据。其核心目标是通过为每个密码添加唯一的随机值，**防止预计算攻击（如彩虹表）**，并确保相同的密码在不同系统中生成不同的哈希结果。

#### **二、工作原理**

1. **盐的生成**
   - 使用加密安全的随机数生成器（CSPRNG）生成固定长度的随机字符串（如 16 字节）。
   - 盐值必须**不可预测**且**唯一**，通常每个密码对应一个盐。
2. **盐与密码的结合**
   - 将盐与密码明文拼接后再进行哈希运算，例如： $\text{Hash} = \text{HMAC}(K, \text{salt} \mathbin\| \text{password}) $（或使用 PBKDF2、BCrypt 等算法）。
3. **存储方式**
   - 将盐与哈希结果一起存储（如数据库中），验证时需同时读取盐值和哈希值。

#### **三、加盐的必要性**

1. **防御彩虹表攻击**
   - 彩虹表是预先计算的常见密码哈希对照表。加盐后，相同密码的哈希结果因盐不同而不同，彩虹表失效。
2. **防止字典攻击**
   - 攻击者无法批量验证哈希值，必须为每个盐重新计算哈希。
3. **增强密码空间**
   - 盐值相当于增加了密码的有效长度。例如，16 字节的盐使有效密码长度增加 128 位。